import Meta from "@/components/Meta";

<Meta pageTitle="How it works | Storage Plugin" description="How it works | Storage Plugin" />





# How it works

##

<br />

- ## Working

  <br />

  - Storage plugin instance will be registered as a service inside your **backend-engine**.

  <br />

  - Storage plugin instance will be running with a **Dapr Sidecar** which
    is managed by your **Backend-Engine** plugin.

  <br />

  - Your storage plugin instance is written in **Express App** which is connected
    with your **Glue Plugin Graphql** and **Glue Plugin Backend-Engine** and it is
    already configured with **Glue Plugin Minio** in order to store the files which is
    running behind the scene.

  <br />

  - Behind the scene what is happening is, there is an **Express.js** application
    inside which it is connected with **minio** and **graphql**. There are routes present
    already for uploading the file and getting the details of already uploaded file.

  <br />

  - If the storage plugin is installed correctly, then you will get a folder named storage
    inside your functions folder, where your whole logic of file upload and saving its information
    to graphql is written.

  <br />

  - Your directory stucture for the **storage plugin instance** should be something
    like this:

    {" "}
    <br />

    ```jsx
      ğŸ“¦storage
        â”£ ğŸ“‚dist
        â”£ ğŸ“‚node_modules
        â”£ ğŸ“‚src
        â”ƒ â”£ ğŸ“‚controllers
        â”ƒ â”ƒ â”£ ğŸ“‚storage
        â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚graphql
        â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œmutations.ts
        â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œqueries.ts
        â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚handlers
        â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œfile.ts
        â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œget.ts
        â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œindex.ts
        â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œupload.ts
        â”ƒ â”ƒ â”ƒ â”— ğŸ“œhelpers.ts
        â”ƒ â”ƒ â”— ğŸ“œcommons.ts
        â”ƒ â”£ ğŸ“‚middlewares
        â”ƒ â”ƒ â”— ğŸ“œ.gitkeep
        â”ƒ â”£ ğŸ“‚providers
        â”ƒ â”ƒ â”£ ğŸ“œexpress.ts
        â”ƒ â”ƒ â”£ ğŸ“œlocals.ts
        â”ƒ â”ƒ â”— ğŸ“œroutes.ts
        â”ƒ â”£ ğŸ“‚routes
        â”ƒ â”ƒ â”£ ğŸ“œ.gitkeep
        â”ƒ â”ƒ â”— ğŸ“œstorage.ts
        â”ƒ â”— ğŸ“œindex.ts
        â”£ ğŸ“œ.env
        â”£ ğŸ“œDockerfile
        â”£ ğŸ“œREADME.md
        â”£ ğŸ“œpackage.json
        â”£ ğŸ“œrouter.js
        â”— ğŸ“œtsconfig.json
    ```

    <br />
    <br />

  - In order to interact with this plugin there is a file named **router.js**
    present in root directory of the instance. If you open that **router.js**
    file, you will see a string value attached to a key named **path**, this
    is the string which we need to append after your nginx url(http://localhost:9090).

    In my case my path value will be something like this:

    ```jsx
    module.exports = () => [
      {
        path: "/backend/storage/upload/(.*)",
        size_in_mb: 100,
        proxy: {
          instance: "storage:3500",
          path: "/v1.0/invoke/storage/method/upload/$1",
        },
      },
    ];
    ```

    <br />

    So in order to access my **storage plugin instance** its base url should be
    something like this,

    **http://localhost:9090/backend/storage/upload/**

  <br />
  <br />

  - In order to start this plugin you need to run the following command:

    <br />

    ```bash
    $ node glue develop:up
    ```

    <br />

    This command will start running the docker image of all the instances
    and plugin you have created. Here, in this case it will start running
    your **storage plugin instance image**, inside your **backend-engine** container.

  <br />

- ## Instructions to start development of with this plugin

  <br />

  - Inside your **storage instance directory** you will see that there is
    directory named **src** inside which there is an **express** app wirtten in
    **typescript**. You can go ahead and start your development from there.
